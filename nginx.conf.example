server {
    listen 80;
    server_name your-domain.com;

    # 代理到Next.js应用
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        
        # 重要：增加允许的请求体大小到100MB
        client_max_body_size 100M;
        
        # 增加超时设置以处理大文件上传
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
    }

    # 静态文件缓存设置
    location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
        proxy_pass http://localhost:3000;
        expires 30d;
    }
}

# 在http块级别也设置body大小限制（全局设置）
# 注意：这部分应该放在/etc/nginx/nginx.conf中的http部分
# http {
#     ...
#     client_max_body_size 100M;
#     ...
# } 